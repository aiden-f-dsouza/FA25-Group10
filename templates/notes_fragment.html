{% for n in notes %}
<div class="card">
  <div id="note-content-{{ n.id }}" class="note-content">
    <div class="note-title">{{ n.title }}</div>
    <div class="note-meta">
      <span class="meta-tag">ğŸ‘¤ {{ n.author }}</span>
      <span class="meta-tag">ğŸ“… {{ n.created }}</span>
      <span class="meta-tag">ğŸ“š {{ n.class }}</span>
      <span class="meta-tag">â¤ï¸ {{ n.likes or 0 }}</span>
      <span class="meta-tag">ğŸ’¬ {{ n.comments|length }}</span>
      {# Tags badges on note #}
      {% if n.tags %}
        {% for tag in n.tags %}
          <a href="/?tag_filter={{ tag }}" class="meta-tag" style="text-decoration:none;">#{{ tag }}</a>
        {% endfor %}
      {% endif %}
      {# Hashtags badges on note #}
      {% if n.hashtags %}
        {% for ht in n.hashtags %}
          <a href="/?tag_filter={{ ht }}" class="meta-tag" style="text-decoration:none; background:rgba(245,101,101,0.2); color:#c53030;">#{{ ht }}</a>
        {% endfor %}
      {% endif %}
    </div>
    <div class="note-body">{{ n.body }}</div>
  </div>

  <div id="edit-form-{{ n.id }}" class="edit-form">
    <form method="POST" action="/edit/{{ n.id }}">
      <div style="margin-bottom: 12px;">
        <input type="text" name="title" value="{{ n.title }}" placeholder="Note title" required style="width: 100%;">
      </div>
      <div style="margin-bottom: 12px;">
        <input type="text" name="author" value="{{ n.author }}" placeholder="Author name" style="width: 100%;">
      </div>
      <div style="margin-bottom: 12px;">
        <select name="class" style="width: 100%;">
          {% for c in classes %}
          <option value="{{ c }}" {% if c == n.class %}selected{% endif %}>{{ c }}</option>
          {% endfor %}
        </select>
      </div>
      <div style="margin-bottom: 12px;">
        <!-- Tags input for editing (comma-separated) -->
        <input type="text" name="tags" value="{{ n.tags|join(', ') }}" placeholder="tags (comma-separated)" style="width:100%;">
      </div>
      <div style="display: flex; gap: 10px;">
        <button type="submit" class="btn-small btn-edit">ğŸ’¾ Save Changes</button>
        <button type="button" class="btn-small btn-cancel" onclick="toggleEdit('{{ n.id }}')">âŒ Cancel</button>
      </div>
    </form>
  </div>

  <div class="note-actions">
    <button class="btn-small btn-edit" onclick="toggleEdit('{{ n.id }}')">âœï¸ Edit</button>
    <form method="POST" action="/delete/{{ n.id }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this note?');">
      <button type="submit" class="btn-small btn-delete">ğŸ—‘ï¸ Delete</button>
    </form>
    <!-- Like button -->
    <form method="POST" action="/like/{{ n.id }}" style="display:inline; margin-left:8px;">
      <button type="submit" class="btn-small" title="Like">â¤ï¸ Like</button>
    </form>
  </div>
  <!-- Quick comment form -->
  <div style="margin-top: 12px;">
    <form method="POST" action="/comment/{{ n.id }}" style="display:flex; gap:8px; align-items:center;">
      <input type="text" name="comment_author" placeholder="Name" style="padding:8px 12px; border-radius:8px; border:1px solid rgba(102,126,234,0.2); background: rgba(23,27,46,0.6); color:#e4e6eb; font-size:13px; width:140px;">
      <input type="text" name="comment_body" placeholder="Add a short comment" style="flex:1; padding:8px 12px; border-radius:8px; border:1px solid rgba(102,126,234,0.2); background: rgba(23,27,46,0.6); color:#e4e6eb; font-size:13px;">
      <button type="submit" class="btn-small btn-edit">ğŸ’¬</button>
    </form>
  </div>
</div>
{% endfor %}
